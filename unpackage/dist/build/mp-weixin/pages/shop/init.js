(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/shop/init"],{"19f0":function(e,o,t){"use strict";var n,a=function(){var e=this,o=e.$createElement;e._self._c},s=[];t.d(o,"b",(function(){return a})),t.d(o,"c",(function(){return s})),t.d(o,"a",(function(){return n}))},"1b57":function(e,o,t){},"2e8e":function(e,o,t){"use strict";(function(e){t("36ef");n(t("66fd"));var o=n(t("8950"));function n(e){return e&&e.__esModule?e:{default:e}}e(o.default)}).call(this,t("543d")["createPage"])},"6f3a":function(e,o,t){"use strict";(function(e){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var n,a=t("1bb3"),s={data:function(){return{shopApi:"/clmsj/Shop/addShop",shopInfo:{logo:"",cover:""}}},onShow:function(){},onLoad:function(){this.loadData()},methods:{loadData:function(){if(e.getStorageSync("session_key")){e.getStorageSync("userInfo");n=this,e.request({url:n.$Url+"/clmsj/Shop/getShop",header:{auth:e.getStorageSync("session_key")},method:"POST",success:function(e){0==e.data.code&&(console.log("res.data.data.shop.length=="+!e.data.data.shop),e.data.data.shop.id&&(n.shopInfo=e.data.data.shop,console.log("shop 有数据")))}})}else e.navigateTo({url:"/pages/public/login"})},submit:function(){if(n.shopInfo.name){if(Number(n.shopInfo.id)>0)this.shopApi="/clmsj/Shop/editShop";else if(!n.shopInfo.leader_code)return void n.$api.msg("请填写上级的开店邀请码");e.showLoading({title:"提交中..."}),e.request({url:n.$Url+this.shopApi,data:n.shopInfo,header:{auth:e.getStorageSync("session_key")},method:"POST",success:function(o){e.hideLoading(),0==o.data.code?(Number(n.shopInfo.id)>0?n.$api.msg("信息更新成功"):n.$api.msg("店铺申请成功，您可以去选择商品进行铺货了"),setTimeout((function(){e.navigateTo({url:"/pages/user/user"})}),1500)):(n.$api.msg("更新失败! "+o.data.msg),1==o.data.code&&e.navigateTo({url:"/pages/user/user"}))}})}else n.$api.msg("请填写您的店铺名")},uploadImage:function(o,t){if(void 0!=o.filePath){var s=new Date,i="clmsj/"+s.getFullYear()+"/"+s.getMonth()+"-"+s.getDate()+"/";return console.log(n.shopInfo),console.log(n.shopInfo),c(0),!1}function c(e){var s=o.filePath[e].split("."),u="."+s[s.length-1],r=Math.random().toString(36).substr(3,8)+Date.now().toString(36),l=i+r+u;a.upload(o.filePath[e],(function(a){n.shopInfo[t.key]="http://"+a.imageURL,console.log("成功==="+n.shopInfo[t.key]),console.log(n.shopInfo),e<o.filePath.length-1&&(e++,c(e)),n.$forceUpdate()}),(function(e){console.log("error: "),console.log(e)}),{region:"SCN",domain:"pic.clmsj.com",key:l,uptoken:o.token,shouldUseQiniuFileName:!1})}e.showToast({icon:"none",title:"请选择需要更新的图片"})},clchooseImage:function(o){var t=this;console.log("clchooseImage");var a={token:[],key:[],filePath:[]};e.chooseImage({sizeType:["original","compressed"],sourceType:["album","camera"],count:o.count,success:function(s){a.filePath=a.filePath.concat(s.tempFilePaths),e.request({url:n.$Url+"/clmsj/goods/qiniu_token",header:{auth:e.getStorageSync("session_key")},success:function(e){a.token=e.data.data,t.uploadImage(a,o)}})},fail:function(e){console.log(e)}})},previewImage:function(o){var t=o.target.dataset.src;e.previewImage({current:t,urls:[t]})}}};o.default=s}).call(this,t("543d")["default"])},8950:function(e,o,t){"use strict";t.r(o);var n=t("19f0"),a=t("e44b");for(var s in a)"default"!==s&&function(e){t.d(o,e,(function(){return a[e]}))}(s);t("c720");var i,c=t("f0c5"),u=Object(c["a"])(a["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],i);o["default"]=u.exports},c720:function(e,o,t){"use strict";var n=t("1b57"),a=t.n(n);a.a},e44b:function(e,o,t){"use strict";t.r(o);var n=t("6f3a"),a=t.n(n);for(var s in n)"default"!==s&&function(e){t.d(o,e,(function(){return n[e]}))}(s);o["default"]=a.a}},[["2e8e","common/runtime","common/vendor"]]]);